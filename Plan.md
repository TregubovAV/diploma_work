# План автоматизации дипломного проекта

## Сценарии для автоматизации

### I. Позитивные сценарии (Happy path)

#### 1. Покупка тура по дебетовой карте (APPROVED)
- **Входные данные (валидные):**
  - **Номер карты:** `4444 4444 4444 4441` — валидная карта, одобренная эмулятором банка
  - **Месяц:** `01`–`12`, текущий или будущий (например, `09`)
  - **Год:** текущий или до +5 лет (например, `27`, если сейчас 2025)
  - **Владелец:** латиницей, две части имени (например, `John Smith`)
  - **CVC/CVV:** трёхзначный код, только цифры (например, `123`)
- **Шаги:** Открыть форму оплаты, ввести валидные данные, нажать "Продолжить"
- **Ожидаемый результат:** Отображается уведомление об успешной оплате, в БД:
  - `payment_entity.status = APPROVED`
  - создана связанная запись в `order_entity`

#### 2. Покупка тура в кредит (APPROVED)
- **Входные данные (валидные):**
  - **Номер карты:** `4444 4444 4444 4441` — одобренная карта
  - **Месяц:** `01`–`12`, например, `11`
  - **Год:** допустимый диапазон, например, `26`
  - **Владелец:** допустимое имя, например, `Alice Johnson`
  - **CVC:** корректный код, например, `456`
- **Шаги:** Перейти на вкладку "Кредит", заполнить форму валидными данными, нажать "Продолжить"
- **Ожидаемый результат:** Отображается сообщение об успешной отправке заявки на кредит. В БД:
  - `credit_request_entity.status = APPROVED`
  - создана запись в `order_entity`

---

### II. Негативные сценарии — отклонённая карта (DECLINED)

#### 3. Покупка по отклонённой карте (DECLINED)
- **Входные данные (валидные, кроме номера карты):**
  - **Номер карты:** `4444 4444 4444 4442` — отклонённая карта, возвращает статус `DECLINED`
  - **Месяц:** любой валидный, например, `10`
  - **Год:** любой валидный, например, `26`
  - **Владелец:** допустимое имя латиницей, например, `Robert Brown`
  - **CVC/CVV:** корректный код, например, `321`
- **Шаги:**
  1. Открыть главную страницу приложения
  2. Перейти во вкладку "Оплата по карте"
  3. Заполнить форму указанными выше данными
  4. Нажать кнопку "Продолжить"
- **Ожидаемый результат:**
  - На странице появляется уведомление об ошибке (операция отклонена)
  - В БД:
    - `payment_entity.status = DECLINED`
    - в таблице `order_entity` появляется связанная запись

#### 4. Кредит по отклонённой карте
- **Аналогично предыдущему**, но для формы кредита

---

### III. Проверка валидации — Пустые поля

#### 5. Пустое поле "Номер карты"
- **Входные данные:**
  - Номер карты: `""`
  - Месяц: `12`
  - Год: `26`
  - Владелец: `John Smith`
  - CVC: `123`
- **Форма:** "Оплата по карте" и "Покупка в кредит"
- **Шаги:**
  1. Открыть соответствующую форму
  2. Заполнить все поля, кроме "Номер карты"
  3. Нажать кнопку "Продолжить"
- **Ожидаемый результат:** 
  - Под полем "Номер карты" отображается сообщение: `"Поле обязательно для заполнения"` или `"Неверный формат"`

---

#### 6. Пустое поле "Месяц"
- **Входные данные:**
  - Номер карты: `4444 4444 4444 4441`
  - Месяц: `""`
  - Год: `26`
  - Владелец: `John Smith`
  - CVC: `123`
- **Форма:** "Оплата по карте" и "Покупка в кредит"
- **Шаги:**
  1. Открыть соответствующую форму
  2. Заполнить все поля, кроме "Месяц"
  3. Нажать "Продолжить"
- **Ожидаемый результат:**
  - Под полем "Месяц" отображается сообщение: `"Поле обязательно для заполнения"` или `"Неверный формат"`

---

#### 7. Пустое поле "Год"
- **Входные данные:**
  - Номер карты: `4444 4444 4444 4441`
  - Месяц: `10`
  - Год: `""`
  - Владелец: `John Smith`
  - CVC: `123`
- **Форма:** "Оплата по карте" и "Покупка в кредит"
- **Шаги:**
  1. Открыть соответствующую форму
  2. Заполнить все поля, кроме "Год"
  3. Нажать "Продолжить"
- **Ожидаемый результат:**
  - Под полем "Год" отображается сообщение: `"Поле обязательно для заполнения"` или `"Неверный формат"`

---

#### 8. Пустое поле "Владелец"
- **Входные данные:**
  - Номер карты: `4444 4444 4444 4441`
  - Месяц: `10`
  - Год: `26`
  - Владелец: `""`
  - CVC: `123`
- **Форма:** "Оплата по карте" и "Покупка в кредит"
- **Шаги:**
  1. Открыть соответствующую форму
  2. Заполнить все поля, кроме "Владелец"
  3. Нажать "Продолжить"
- **Ожидаемый результат:**
  - Под полем "Владелец" отображается сообщение: `"Поле обязательно для заполнения"`

---

#### 9. Пустое поле "CVC/CVV"
- **Входные данные:**
  - Номер карты: `4444 4444 4444 4441`
  - Месяц: `10`
  - Год: `26`
  - Владелец: `John Smith`
  - CVC: `""`
- **Форма:** "Оплата по карте" и "Покупка в кредит"
- **Шаги:**
  1. Открыть соответствующую форму
  2. Заполнить все поля, кроме "CVC/CVV"
  3. Нажать "Продолжить"
- **Ожидаемый результат:**
  - Под полем "CVC/CVV" отображается сообщение: `"Неверный формат"`

---

#### 10. Полностью пустая форма
- **Шаги:** Не заполнять ни одно поле
- **Ожидаемый результат:** Ошибки под всеми полями

---

### IV. Невалидные значения

#### 11. Невалидный номер карты (некорректный формат)
- **Входные данные:**
  - Номер карты: `1234 5678 9012 3456` (неизвестная карта, невалидный BIN)
  - Месяц: `12`
  - Год: `26`
  - Владелец: `John Smith`
  - CVC: `123`
- **Форма:** "Оплата по карте" и "Покупка в кредит"
- **Шаги:**
  1. Открыть соответствующую форму
  2. Ввести номер карты `1234 5678 9012 3456`
  3. Заполнить остальные поля корректными значениями
  4. Нажать кнопку "Продолжить"
- **Ожидаемый результат:**
  - Под полем "Номер карты" появляется сообщение об ошибке: `"Неверный формат"` или `"Неверный номер карты"`
  - Платеж не проводится
  - В базе данных отсутствуют записи в `payment_entity` или `credit_request_entity` (в зависимости от формы)
  - В таблице `order_entity` также не создаётся запись

---

#### 12. Месяц: значение `13` (выходит за допустимый диапазон)
- **Входные данные:**
  - Номер карты: `4444 4444 4444 4441`
  - Месяц: `13`
  - Год: `26`
  - Владелец: `John Smith`
  - CVC: `123`
- **Шаги:**
  1. Открыть форму оплаты
  2. Ввести указанные данные
  3. Нажать "Продолжить"
- **Ожидаемый результат:**
  - Под полем "Месяц" отображается сообщение об ошибке: `"Неверно указан срок действия карты"`

---

#### 13. Месяц: значение `00` (не может быть нулевым)
- **Входные данные:**
  - Номер карты: `4444 4444 4444 4441`
  - Месяц: `00`
  - Год: `26`
  - Владелец: `John Smith`
  - CVC: `123`
- **Шаги и результат:** аналогично сценарию 12

---

#### 14. Месяц: прошедший (например, `01`, если сейчас май)
- **Входные данные:** Месяц в прошлом относительно текущей даты
- **Ожидаемый результат:** `"Неверно указан срок действия карты"`

---

#### 15. Год: `00` (в прошлом)
- **Входные данные:**
  - Год: `00` (2000)
- **Ожидаемый результат:** Сообщение: `"Неверно указан срок действия карты"`

---

#### 16. Год: `текущий + 7` (слишком далеко в будущем)
- **Пример:** если сейчас 2025, год: `32`
- **Ожидаемый результат:** `"Неверно указан срок действия карты"`

---

#### 17. Владелец на кириллице
- **Входные данные:**
  - Владелец: `Иван Иванов`
- **Ожидаемый результат:** `"Неверный формат"`

---

#### 18. Владелец: спецсимволы
- **Пример:** `@#$%`
- **Ожидаемый результат:** `"Неверный формат"`

---

#### 19. Владелец: цифры
- **Пример:** `123456`
- **Ожидаемый результат:** `"Неверный формат"`

---

#### 20. CVC: `1` (меньше 3 символов)
- **Ожидаемый результат:** `"Неверный формат"`

---

#### 21. CVC: `ab1` (содержит буквы)
- **Ожидаемый результат:** `"Неверный формат"`

---

#### 22. CVC: `0` (невалидное значение)
- **Ожидаемый результат:** `"Неверный формат"`

---

### V. Эквивалентные классы и граничные значения

#### 23. Имя владельца: длиннее 50 символов
- **Пример:** `Jonathan Livingston Seagull the Third from California`
- **Ожидаемый результат:** Ошибка `"Неверный формат"` или обрезка

---

#### 24. CVC: `000` (валидный по шаблону, но граничный случай)
- **Ожидаемый результат:** В зависимости от реализации — принимается или ошибка `"Неверный формат"`

---

#### 25. Неизвестная карта (не из data.json)
- **Пример:** `4000 0000 0000 0002`
- **Ожидаемый результат:** Отображается ошибка, статус в БД: `DECLINED`, `order_entity` создаётся

---

## Итого

Покрываются:
- Все поля формы (валидность и обязательность)
- Успешные и неуспешные сценарии
- Реакция системы на невалидный ввод
- Проверка записей в БД (`payment_entity`, `credit_request_entity`, `order_entity`)


## Используемые инструменты

- **Selenide + JUnit5** — удобные и стабильные UI-тесты.
- **Apache DBUtils** — упрощает работу с БД (SQL).
- **Faker** — генерация случайных данных.
- **Allure** — наглядная отчётность по шагам, скриншотам.
- **Docker + docker-compose** — управление окружением.
- **Gradle** — запуск, отчёты и зависимости.

## Возможные риски

- Сложности в переключении между MySQL и PostgreSQL.
- Баги в логике приложения, влияющие на стабильность тестов.
- Проблемы с запуском симулятора банка или `aqa-shop.jar`.
- Непредсказуемое поведение на нестабильных картах.

## Оценка трудозатрат (интервал в часах)

| Этап                        | Время (ч) |
|----------------------------|-----------|
| Подготовка окружения       | 1–2       |
| UI-тесты                   | 4–6       |
| SQL-тесты                  | 4–6       |
| Настройка Allure и отчётов | 2–3       |
| Написание документации     | 2–4       |
| Резерв                     | 3–4       |
| **ИТОГО**                  | **16–25** |

## План сдачи

- **День 1:** Подготовка окружения, `Plan.md`, запуск jar.
- **День 2–4:** Разработка UI- и SQL-тестов, Allure.
- **День 5:** Сбор отчётов, оформление багов.
- **День 5:** Финальная проверка и сдача проекта.